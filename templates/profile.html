<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Profile</title>
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link href="/static/css/style.css" rel="stylesheet">
    <script src="/static/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/jquery-3.6.0.min.js"></script>

    <script src="/static/js/jquery.dialog.js"></script>
    <link rel="stylesheet" href="/static/css/dialog.css">


    <script>
        $(document).ready(function(){
            $(".card").mouseenter(function(){
                $(".card:hover").removeClass("shadow-pulse-inverse");
                $(".card:hover").addClass("selectedCard shadow-pulse");
            }).mouseleave(function(){
                $(".selectedCard").addClass("shadow-pulse-inverse");
                $(".selectedCard").removeClass("selectedCard shadow-pulse");
            });
        });
    </script>
</head>

<body>
    <header>
        <nav class="navbar-dark fixed-top bg-dark" style="border-radius: 0 0 10px 10px;">
            <div class="navigator">
                <div style="display: flex;">
                    <img src="/static/pic/CuSell_icon.jpeg" alt="Icon" height="30px" width="30px" style="margin-top: 4.5px; margin-left: 10px; margin-right: 3px; border-radius: 5px;">
                    <a class="navbar-brand" href="/templates/mainpage.html" style="padding-top: 2px; padding-bottom: 0;">
                        <b><span style="color: purple; font-size: x-large;">Cu</span><span style="color: orange; font-size: x-large;">Sell</span></b>
                    </a>
                    <ul class="nav">
                        <li><a href="/templates/mainpage.html" class="nav-link px-2 text-white top_item">Home</a></li>
                        <li><a href="#" class="nav-link px-2 text-white top_item" style="background-color: #6c757d; border-collapse: collapse; border-radius: 5px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-person-bounding-box" viewBox="0 0 16 16">
                                <path d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1h-3zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5zM.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5z"/>
                                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm8-9a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                            </svg>
                            Profile</a></li>
                        <li><a href="/templates/post.html" class="nav-link px-2 text-white top_item">Post</a></li>
{#                        <li><a href="#" class="nav-link px-2 text-white top_item">Chat</a></li>#}
                        <li><a target="_blank" href="https://github.com/1155141394/CuSell" class="nav-link px-2 text-white top_item">About Us</a></li>
                    </ul>
                </div>

                <div style="padding-right: 10px; display: flex; align-items: center;">
                    <p style="color: white; margin-bottom: 0; font-size: larger; margin-right: 10px;">Hello, {{user.name}}!</p>
                    <div id="user-head-nav" style="overflow: hidden;">
                        <img src="{{ MEDIA_URL }}{{ user.portrait }}" width="110%" height="110%" style="position: relative; left: -5%; top: -5%;">
                    </div>
                    <form id="signupForm" method="post" >
                        <span style="display: none;">{% csrf_token %}</span>
                        <button name="signout" type="submit" id="signout_button" value="True" class="btn btn-primary">Sign Out</button>
                    </form>
                    
                </div>

            </div>
        </nav>
    </header>


     
    <div style="width: 100%; height: 90%; position: fixed; z-index: -1; display: flex; justify-content: flex-end; align-items: flex-end;">
        <svg xmlns="http://www.w3.org/2000/svg" width="500" height="500" fill="currentColor" class="bi bi-bag-heart" viewBox="0 0 16 16" style="opacity: 0.4; color: orange">
            <path fill-rule="evenodd" d="M10.5 3.5a2.5 2.5 0 0 0-5 0V4h5v-.5Zm1 0V4H15v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4h3.5v-.5a3.5 3.5 0 1 1 7 0ZM14 14V5H2v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1ZM8 7.993c1.664-1.711 5.825 1.283 0 5.132-5.825-3.85-1.664-6.843 0-5.132Z"/>
        </svg>
    </div>
    <svg xmlns="http://www.w3.org/2000/svg" width="500" height="500" fill="currentColor" class="bi bi-cart-check-fill" viewBox="0 0 16 16" style="opacity: 0.3; position:fixed ; z-index: -1; left: 10px; top: 30px; color: purple">
        <path d="M.5 1a.5.5 0 0 0 0 1h1.11l.401 1.607 1.498 7.985A.5.5 0 0 0 4 12h1a2 2 0 1 0 0 4 2 2 0 0 0 0-4h7a2 2 0 1 0 0 4 2 2 0 0 0 0-4h1a.5.5 0 0 0 .491-.408l1.5-8A.5.5 0 0 0 14.5 3H2.89l-.405-1.621A.5.5 0 0 0 2 1H.5zM6 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm7 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-1.646-7.646-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L8 8.293l2.646-2.647a.5.5 0 0 1 .708.708z"/>
    </svg>

    

    <div class="card-box" style="width: 90%; margin: 0 auto; margin-top: 30px; justify-content: space-between;">

        <button id="change-passwd" class="btn btn-primary" style="position: absolute; right: 5%; top: 8%;">Change Password</button>

        <div id="user-head" style="border: none;">
            <div id="edit-box" class="edit-box transparent">
                <div style="width: 100%; display: flex; justify-content: center; padding-top: 12px;">
                    <form id="upload" action="/templates/profile.html/" method = "post" enctype="multipart/form-data" onchange="submit.click()">
                        {% csrf_token %}
                        <a id="upload-head-link" href="#" style="font-size: 25px; color: white;">Upload</a>
                        <input id="upload-head" type="file" name="img" style="display: none;">
                        <button id="submit" type="submit" hidden="hidden"></button>
                    </form>
                </div>
            </div>
           
            <div style="border: #6c757d 2px solid; height: 250px; width: 250px; position: absolute; z-index: -100; top: 30px; border-radius: 50%; overflow: hidden;">
                <img src="{{ MEDIA_URL }}{{ user.portrait }}" height="100%" width="100%">
            </div>
            
        </div>

        <script>
            $("#user-head").mouseenter(function(){
                $("#edit-box").removeClass("transparent")
            }).mouseleave(function(){
                $("#edit-box").addClass("transparent")
            });
            $("#upload-head-link").click(function(){
                $("#upload-head").click()
            });
        </script>

        <div id="userName-box" style="display: flex; margin-top: 20px;">
            <p id="userName" style="font-size: xx-large; margin-left: 40px;">
                <b>{{user.name}}</b>
            </p>
            <a href="#" id="userName-icon" class="transparent" style="pointer-events: none;">
                <svg xmlns="http://www.w3.org/2000/svg" style="margin-top: 10px; margin-left: 10px;" width="30" height="30" fill="currentColor" class="bi bi-pencil-square text-primary" viewBox="0 0 16 16">
                    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                </svg>
            </a>
        </div>

        <script>
            $("#userName").mouseenter(function(){
                $("#userName-icon").removeClass("transparent").css("pointer-events","auto")
            });
            $("#userName-box").mouseleave(function(){
                $("#userName-icon").addClass("transparent").css("pointer-events","none")
            });
            $("#userName-icon").click(function(){
                $.sendConfirm({
                    title: 'Change Username',
                    withNoMinWidth: true,
                    width: '400px',
                    content: '<form method="post">'
                        + '{% csrf_token %}'
                        + '<p>Input your new username:</p>'
                        + '<input type="text" name="new_username" style="font-size: large; padding: 3px; width: 100%">'
                        + '<button id="submit-username" type="submit" hidden></button>'
                        + '</form>',
                    button: {
                        confirm: 'Confirm',
                        cancel: 'Cancel'
                    },
                    onBeforeConfirm: function() {
                        $('#submit-username').click();
                    },
                    onConfirm: function() {
                        $('#submit-username').click();
                    },
                    onCancel: function() {
                        console.log('点击取消！');
                    },
                    onClose: function() {
                        console.log('点击关闭！');
                    }
                });
            })
        </script>

        <div class="discription">
            <div id="discription-box" style="display: flex;">
                <p id="discription" style="font-size: x-large; margin-top: 10px; margin-bottom: 10px; margin-left: 30px; color: purple;">
                    About Me
                </p>
                
                <a href="#" id="discription-icon" class="transparent" style="pointer-events: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" style="margin-top: 18px; margin-left: 10px;" width="20" height="20" fill="currentColor" class="bi bi-pencil-square text-primary" viewBox="0 0 16 16">
                        <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                        <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                    </svg>
                </a>
            </div>
            <p style="font-size: x-large;">{{user.introduction}}</p>

            <script>
                $("#discription").mouseenter(function(){
                    $("#discription-icon").removeClass("transparent").css("pointer-events","auto")
                });
                $("#discription-box").mouseleave(function(){
                    $("#discription-icon").addClass("transparent").css("pointer-events","none")
                });
            </script>

            <ul class="nav nav-pills" style="position: absolute; bottom: 0; width: 50%; display: flex; justify-content: space-between;">
                <li class="nav-item">
                <a class="nav-link active" href="/templates/profile.html">My Goods</a>
                </li>
                <li class="nav-item" >
                    <a class="nav-link" href="/templates/liked.html">My Likes</a>
                </li>
            </ul>
        </div>
        
    </div>

    <button id="edit-intro" hidden="hidden"></button>
    <script>
        $("#discription-icon").click(function(){
            $('#edit-intro').click()
        })
        $('#edit-intro').click(function() {
            $.sendConfirm({
                title: 'Write Something About You!',
                withNoMinWidth: true,
                width: '600px',
                content: '<form id="intro" method="post">'
                    + '{% csrf_token %}'
                    + '<textarea name="introduction" style="width:100%; height:300px; font-size: x-large; padding: 10px;"></textarea>'
                    + '<button id="submit-intro" type="submit" hidden="hidden"></button>'
                    + '</form>',
                button: {
                    confirm: 'Confirm',
                    cancel: 'Cancel'
                },
                onBeforeConfirm: function() {
                    $('#submit-intro').click();
                },
                onConfirm: function() {
                    $('#submit-intro').click();
                },
                onCancel: function() {
                    console.log('点击取消！');
                },
                onClose: function() {
                    console.log('点击关闭！');
                }
            });
        });
        $('#change-passwd').click(function() {
            $.sendConfirm({
                title: 'Change Password',
                withNoMinWidth: true,
                width: '400px',
                content: '<form method="post">'
                    + '{% csrf_token %}'
                    + '<p>Input your new password:</p>'
                    + '<input type="text" name="new_password" style=" font-size: large; padding: 3px; width: 100%">'
                    + '<button id="submit-passwd" type="submit" hidden="hidden"></button>'
                    + '</form>',
                button: {
                    confirm: 'Confirm',
                    cancel: 'Cancel'
                },
                onBeforeConfirm: function() {
                    $('#submit-passwd').click();
                },
                onConfirm: function() {
                    $('#submit-passwd').click();
                },
                onCancel: function() {
                    console.log('点击取消！');
                },
                onClose: function() {
                    console.log('点击关闭！');
                }
            });
        });
    </script>

    <form method="post" id="delete">
        {% csrf_token %}
        <input id="delete-text" type="text" name="delete" hidden="hidden">
    </form>

    <script>
        function dialog(value){
            $.sendConfirm({
                title: 'Warning!',
                withNoMinWidth: true,
                width: '400px',
                content: 'Are you sure to delete this item?',
                button: {
                    confirm: 'Confirm',
                    cancel: 'Cancel'
                },
                onConfirm: function() {
                    document.getElementById('delete-text').value=value;
                    $('#delete').submit()
                },
                onCancel: function() {
                    console.log('点击取消！');
                },
                onClose: function() {
                    console.log('点击关闭！');
                }
            });
        }
    </script>

    <div class="container" style="margin-top: 100px;">
        {% for merchandise in merchandises %}
                <div class="bg">
                    <div class="card">
                        <div class="content">
                            <a href="javascript:" style="z-index: 100; position: absolute; opacity: 1; top: 89%; left: 88%;" onclick="dialog('{{ merchandise.mid }}')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="black" class="bi bi-trash3" viewBox="0 0 16 16">
                                    <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
                                </svg>
                            </a>
                            <a href="/merchandise/{{ merchandise.mid }}" style="text-decoration: none; color: black;">
                                <img src='{{ MEDIA_URL }}{{ merchandise.image_1 }}'>
                            </a>
                            <a href="/merchandise/{{ merchandise.mid }}" style="text-decoration: none; color: black;">
                                <h3 class="good-name">
                                    {{merchandise.name}}
                                </h3>
                            </a>
                            <a href="/merchandise/{{ merchandise.mid }}" style="text-decoration: none; color: black;">
                                <h2>${{merchandise.price}}HKD</h2>
                            </a>
                        </div>
                    </div>
                </div>
        {% endfor %}
    </div>
    <div style="height: 50px;"></div>
</body>
</html>